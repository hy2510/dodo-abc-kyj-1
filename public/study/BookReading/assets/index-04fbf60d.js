import{R as v,r as f,j as p}from"./react-ed353aa7.js";import{c as B}from"./react-dom-a6239d86.js";import{a as u}from"./axios-9cbf0d09.js";/* empty css                    */import"./babel-runtime-6d7c6b87.js";import"./core-js-6b60057b.js";import"./scheduler-765c72db.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function t(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(e){if(e.ep)return;e.ep=!0;const o=t(e);fetch(e.href,o)}})();const N="modulepreload",D=function(n){return"/study/BookReading/"+n},C={},U=function(r,t,s){if(!t||t.length===0)return r();const e=document.getElementsByTagName("link");return Promise.all(t.map(o=>{if(o=D(o),o in C)return;C[o]=!0;const c=o.endsWith(".css"),i=c?'[rel="stylesheet"]':"";if(!!s)for(let l=e.length-1;l>=0;l--){const A=e[l];if(A.href===o&&(!c||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${i}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":N,c||(d.as="script",d.crossOrigin=""),d.href=o,document.head.appendChild(d),c)return new Promise((l,A)=>{d.addEventListener("load",l),d.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>r()).catch(o=>{const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o})},fe={LISTENING_1:"ListeningActivity1",LISTENING_2:"ListeningActivity2",LISTENING_3:"ListeningActivity3",LISTENING_4:"ListeningActivity4",VOCABULARY_1:"Vocabulary1",VOCABULARY_2:"Vocabulary2",VOCABULARY_3:"Vocabulary3",VOCABULARY_4:"Vocabulary4",VOCABULARY_PRACTICE_1:"VocabularyPractice1",VOCABULARY_PRACTICE_2:"VocabularyPractice2",VOCABULARY_PRACTICE_3:"VocabularyPractice3",VOCABULARY_PRACTICE_4:"VocabularyPractice4",VOCABULARY_TEST_1:"VocabularyTest1",VOCABULARY_TEST_2:"VocabularyTest2",VOCABULARY_TEST_3:"VocabularyTest3",VOCABULARY_TEST_4:"VocabularyTest4",READING_COMP_1:"ReadingComprehension1",READING_COMP_2:"ReadingComprehension2",READING_COMP_3:"ReadingComprehension3",READING_COMP_4:"ReadingComprehension4",SUMMARY_1:"Summary1",SUMMARY_2:"Summary2",TRUE_OR_FALSE:"TrueOrFalse",CLOZE_1:"ClozeTest1",CLOZE_2:"ClozeTest2",CLOZE_3:"ClozeTest3",WRITING_1:"WritingActivity1",WRITING_2:"WritingActivity2"},$="api/study/book-reading/quiz/info",z="api/study/book-reading/quiz/e-book",F="api/study/book-reading/book/end",M="api/study/book-reading/book/book-mark",H="api/study/book-reading/book/preference",q="api/study/book-reading/book/animation-complete",ye="api/study/book-reading/quiz/question",O="api/study/book-reading/quiz/record",pe="api/study/book-reading/quiz/hint",G="api/study/book-reading/quiz/save",x="api/study/book-reading/quiz/save/partial-record",Y="api/study/book-reading/quiz/save/writing",W="api/study/book-reading/quiz/save/re-writing",Q="api/study/book-reading/quiz/save/clear-penalty",Ae="api/study/book-reading/speak/e-book",Se="api/study/book-reading/speak/record",we="api/study/book-reading/speak/save";async function Ee(n,r){const t=`/${z}?studentHistoryId=${r}&studyId=${n}`;let s;try{const e=await u.get(t);if(e.status>=200&&e.status<300)s=await e.data;else throw new Error("Get Story Data Failed 1")}catch(e){throw console.error(e),new Error("Get Story Data Failed 2")}return s}async function j(n,r){let t={success:!1};try{const s=await u.post(`/${F}`,{studyId:n,studentHistoryId:r});if(s.status>=200&&s.status<300){const e=await s.data;if(e.success)t=e;else throw new Error("Post Preference Failed 1")}else throw new Error("Post Preference Failed 1")}catch(s){console.error(s)}return t}async function _e(n,r,t){let s={success:!1};try{const e=await u.post(`/${M}`,{studyId:n,studentHistoryId:r,page:t});if(e.status>=200&&e.status<300){const o=await e.data;if(o.success)s=o;else throw new Error("Post Preference Failed 1")}else throw new Error("Post Preference Failed 1")}catch(e){console.error(e)}return s}async function he(n,r){let t={success:!1};try{const s=await u.post(`/${q}`,{studyId:n,studentHistoryId:r});if(s.status>=200&&s.status<300){const e=await s.data;if(e.success)t=e;else throw new Error("Post Preference Failed 1")}else throw new Error("Post Preference Failed 1")}catch(s){console.error(s)}return t}async function Ie(n,r,t){let s={success:!1};try{const e=await u.post(`/${H}`,{studyId:n,studentHistoryId:r,preference:t});if(e.status>=200&&e.status<300){const o=await e.data;if(o.success)s=o;else throw new Error("Post Preference Failed 1")}else throw new Error("Post Preference Failed 1")}catch(e){console.error(e)}return s}const ge=async(n,r)=>{let t={result:"0",resultMessage:""};return n==="Quiz"&&(t=await u.post(`/${G}`,r).then(s=>s.data)),t},Pe=async(n,r)=>{let t={result:"0",resultMessage:""};return n==="Quiz"&&(t=await u.post(`/${x}`,r).then(s=>s.data)),t},Te=async(n,r)=>{let t={result:"0",resultMessage:""};return n==="Quiz"&&(t=await u.post(`/${Y}`,r).then(s=>s.data)),t},Re=async n=>await u.post(`/${W}`,n).then(t=>t.data),me=async(n,r)=>await u.get(`/${O}/${n}?studyId=${r.studyId}&studentHistoryId=${r.studentHistoryId}`).then(async s=>n==="7"?s.data.length>0?s.data:await u.get(`/${O}/5?studyId=${r.studyId}&studentHistoryId=${r.studentHistoryId}`).then(e=>e.data):s.data),be=async n=>await u.post(`/${Q}`,n).then(t=>t.data);async function ve(n,r){const t=`/${n}`;let s;try{const e=await u.get(t);if(e.status>=200&&e.status<300){const o=e.data;s=await r(o)}else throw new Error("QuizData Load Failed 1")}catch(e){throw console.error(e),new Error("QuizData Load Failed 2")}return s}async function ke(n,r){const t=`/${n}`;let s;try{const e=await u.get(t);if(e.status>=200&&e.status<300){const o=e.data;s=await r(o)}else throw new Error("API Load Failed 1")}catch(e){throw console.error(e),new Error("API Load Failed 2")}return s}async function K(n,r,t){const s=`/${$}/${t}?studentHistoryId=${r}&studyId=${n}`;let e;try{const o=await u.get(s);if(o.status>=200&&o.status<300)e=await o.data;else throw new Error("API Load Failed 1")}catch(o){throw console.error(o),new Error("API Load Failed 2")}return e}async function Z(n,r,t){const s=`/api/library/book-info?studentHistoryId=${r}&studyId=${n}&levelRoundId=${t}`;let e;try{const o=await u.get(s);if(o.status>=200&&o.status<300)e=await o.data;else throw new Error("API Load Failed 1")}catch(o){throw console.error(o),new Error("API Load Failed 2")}return e}const J=v.createContext(void 0);function X({children:n}){const[r,t]=f.useState(!0),[s,e]=f.useState(),[o,c]=f.useState(),[i,y]=f.useState("story"),[d,l]=f.useState({id:0,cause:void 0}),[A,g]=f.useState(!1),[P,S]=f.useState(!1),[w,E]=f.useState(!1),[_,h]=f.useState("Story"),[T,R]=f.useState(!1),[m,k]=f.useState(!1);if(f.useEffect(()=>{ee().then(a=>{c(a),a.studyInfo.isStartSpeak?y("speaking"):a.studyInfo.isSubmitPreference&&!a.studyInfo.isReview&&a.studyInfo.availableQuizStatus===0?(y("quiz"),S(!0)):(a.studyInfo.isReview&&S(!0),a.bookInfo.ReadingCompletedEB==="Y"?E(!0):a.studyInfo.isListenAndRepeat&&h("ListenAndRepeat")),t(!1)}).catch(a=>{e(a)})},[]),s)return p.jsxs("div",{children:["Error: ",s.message]});if(r)return p.jsx("div",{children:"Loading ..."});const I={viewStudy:i,changeView:a=>{a==="quiz"&&(I.isPreference=!0,S(!0)),y(a)},finishStudy:{...d},actionFinishStudy:(a,b)=>{try{window.onFinishStudyResult(a.id,a.cause,b)}catch{location.replace("/")}},clearFinishStudyState:()=>{l({id:0,cause:void 0})},isShowBookInfo:A,setShowBookInfo:a=>{g(a)},isPreference:P,isReadingComplete:w,changeReadingComplete:async(a,b)=>{(!w||_==="Story")&&await j(a,b)&&E(!0)},storyMode:_,changeStoryMode:a=>{h(a)},isReTest:T,changeReTest:a=>{R(a)},isMovieWatched:m,changeMovieWatched:()=>{}},L={...o,handler:{...I}};return p.jsx(J.Provider,{value:L,children:n})}function ee(){return new Promise((n,r)=>{if(window){const t=window.REF,s=t.StudyId,e=t.StudentHistoryId,o=t.BookType,c=t.isStartSpeak,i=t.LevelRoundId,y=t.Token,d=t.isDev!==void 0;te(s,e,o,c,i,y,d).then(l=>n(l)).catch(l=>{r(new Error(l.message))})}else r(new Error("Null Data"))})}async function te(n,r,t,s,e,o,c){try{const i=await se(n,r,t);if(i){const y=i.isSuper,d=i.isReview,l=i.isAvailableSpeaking,A=i.isListenAndRepeat,g=i.isSubmitPreference,P=i.allSteps,S=i.openSteps,w=i.mappedStepActivity,E=i.isQuizLearning,_=i.startStep,h=i.isPassedVocabularyPractice,T=i.availableQuizStatus,R=i.isReTestYn,m=d?"Review":y?"Super":"Quiz",k=i.bookmarkPage,I={studyId:n,studentHistoryId:r,bookType:t,mode:m,isSuper:y,isStartSpeak:s,isReview:d,isAvailableSpeaking:l,isListenAndRepeat:A,isSubmitPreference:g,allSteps:[...P],openSteps:[...S],mappedStepActivity:[...w],isQuizLearning:E,startStep:_,isPassedVocabularyPractice:h,availableQuizStatus:T,isReTestYn:R,token:o,isDev:c,bookmarkPage:k},a={...await oe(n,r,e)};return{studyInfo:I,bookInfo:a}}else throw new Error("Get Study Info Failed")}catch(i){throw new Error(i.message)}}async function se(n,r,t){return await K(n,r,t)}async function oe(n,r,t){return await Z(n,r,t)}function re(){const n=v.lazy(()=>U(()=>import("./StudyContainer-80478b05.js"),["assets/StudyContainer-80478b05.js","assets/react-ed353aa7.js","assets/babel-runtime-6d7c6b87.js","assets/core-js-6b60057b.js","assets/mobile-detect-a4c8f7ad.js","assets/lodash-12888dbd.js","assets/axios-9cbf0d09.js","assets/react-string-replace-7ad9cda0.js","assets/react-device-detect-e6ece92d.js","assets/ua-parser-js-04c823b7.js","assets/react-lottie-1f0d6727.js","assets/prop-types-387d7a00.js","assets/lottie-web-62c494ff.js","assets/react-dom-a6239d86.js","assets/scheduler-765c72db.js","assets/StudyContainer-d73ff92c.css","assets/animate-2d4c25b0.css"]));return p.jsx(X,{children:p.jsx(f.Suspense,{fallback:p.jsx("div",{}),children:p.jsx(n,{})})})}B.createRoot(document.getElementById("root")).render(p.jsx(v.StrictMode,{children:p.jsx(re,{})}));export{J as A,ye as G,we as S,Ae as a,Se as b,Pe as c,be as d,ke as e,pe as f,ve as g,Te as h,Re as i,fe as j,_e as k,me as l,Ie as m,he as n,Ee as o,ge as s};
